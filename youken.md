# VDI-solid 要件定義書

## 1. 概要

本プロジェクトは、既存のVanilla TS製アプリケーション `VDI` を SolidJS フレームワークを用いて再構築する。
バックエンドのRustロジックはそのまま流用し、フロントエンドの機能とUIをSolidJSで効率的かつ宣言的に実装し直すことを目的とする。

## 2. プロジェクト構成

- **フロントエンド**: SolidJS, TypeScript, Vite
- **バックエンド**: Rust, Tauri
- **パッケージ管理**: npm

## 3. 機能要件

### 3.1. 基本機能の移植

`VDI` の以下の機能を `VDI-solid` に移植する。

- **画像表示**: 指定されたパスの画像を表示する。
- **ズーム**: マウスホイールやボタンクリックで画像を拡大・縮小する。
- **パン**: ズーム中に画像をドラッグして表示範囲を移動する。
- **画像ナビゲーション**: 「次へ」「前へ」ボタンで同じディレクトリ内の画像を切り替える。
- **ウィンドウ制御**: カスタムタイトルバーのボタンでウィンドウの最小化、最大化/元に戻す、閉じる操作を行う。
- **テーマ管理**: ライトモード、ダークモード、OS設定追従のテーマ切り替え機能を提供する。
- **設定メニュー**: 以下の機能を持つドロップダウンメニューを実装する。
    - テーマの選択
    - 「エクスプローラーで開く」機能 (`revealItemInDir`)
- **フッター**: 画像パスやズーム率などのステータス情報を表示する。

### 3.2. 画像回転機能の仕様変更

- `VDI` の回転機能を踏襲しつつ、画像の回転軸を常に**中央**に設定する。
- CSSの `transform-origin: center;` を適用して実現する。
- バックエンドの回転処理ロジック (Rust) はそのまま流用する。

### 3.3. フロントエンドの構造

`VDI` のUIを、以下のSolidJSコンポーネントとして再構築する。可読性と保守性を高めるため、機能ごとにディレクトリを分割してコンポーネントを管理する。

- **`src/components/`**: UIコンポーネントを格納する。
    - `Titlebar/`: カスタムタイトルバー。
    - `ImageViewer/`: 画像表示領域の**プレースホルダー**。具体的な画像表示ロジックは手動で実装する。
    - `Footer/`: 画像パスやズーム率を表示するフッター。
    - `Controls/`: 操作ボタン群。
    - `SettingsMenu/`: 設定メニュー。
    - `common/`: 汎用コンポーネント (例: `Button`, `Icon`)。
- **`src/hooks/`**: 状態管理や副作用を扱うカスタムフック (例: `createTheme`) を格納する。
- **`src/lib/`**: Tauri APIのラッパーなど、再利用可能なユーティリティ関数を格納する。
- **`src/assets/`**: SVGアイコンなどの静的ファイルを格納する。
- **`src/types/`**: プロジェクト全体で使用するTypeScriptの型定義を格納する。
- **`src/App.tsx`**: アプリケーションのルートコンポーネント。
- **`src/index.tsx`**: アプリケーションのエントリーポイント。

### 3.4. アセットの流用

- `VDI/src/asset` 内の以下のSVGアイコンを `VDI-solid/src/assets` (または `public`) にコピーして使用する。
    - `focus_ca_h.svg`
    - `moon_hoso.svg`
    - `reload_hoso.svg`
    - `setting_ge_h.svg`
    - `sun_hoso.svg`
- SVGはインラインでレンダリングし、CSSの `currentColor` を利用してテーマに連動した色変更ができるようにする。

## 4. 技術要件

### 4.1. バックエンド (Rust)

- `VDI/src-tauri` ディレクトリの内容（`Cargo.toml`, `build.rs`, `tauri.conf.json`, `src/` フォルダ）を `VDI-solid/src-tauri` にマージする。
- `tauri.conf.json` の `build.distDir` を SolidJS のビルド出力先である `../dist` に更新する。
- 引数の扱いや回転コマンドなどの既存ロジックは変更しない。

### 4.2. フロントエンド (SolidJS)

- **状態管理**: `createSignal` を使用して、画像のパス、ズーム率、回転角度、テーマなどの状態をリアクティブに管理する。
- **Tauri API連携**: `@tauri-apps/api` および関連プラグイン (e.g., `@tauri-apps/plugin-opener`) を使用して、バックエンドとの通信やOSネイティブ機能の呼び出しを行う。
- **スタイリング**: `VDI` の `styles.css` を参考にしつつ、SolidJSのコンポーネント構造に合わせたスタイリングを行う。

## 5. 成果物

- 上記要件を満たす `VDI-solid` アプリケーションのソースコードの骨格。
- 本要件定義書 (`youken.md`)。

## 6. 実装方針とスコープ

### 6.1. 開発の進め方
本プロジェクトは、アプリケーションの骨格部分の自動実装と、コア機能の手動実装の2段階で進める。

### 6.2. 担当範囲
- **自動実装スコープ (Gemini)**:
    - 本要件定義書で定義されたフォルダ構造の作成。
    - `VDI` からのバックエンド(Rust)コードの移植と設定。
    - UIコンポーネントの骨格（`Titlebar`, `Footer`, `Controls`, `SettingsMenu`等）の実装。
    - `ImageViewer` コンポーネントのプレースホルダー（空のコンポーネント）の作成。
    - アプリケーション全体のレイアウトとコンポーネントの統合。
- **手動実装スコープ (ユーザー)**:
    - `ImageViewer` コンポーネント内における、`<img>` 要素を用いた具体的な画像表示機能の実装。
    - 画像の読み込み、回転、ズーム、パンに関する詳細なインタラクションロジックの実装。

## 7. 非機能要件

### 7.1. コード品質
- 変数名、関数名、コンポーネント名は、その役割が明確にわかるように命名する。
- 複雑なロジックには、その意図を説明するコメントを簡潔に記述する。
- 機能ごとにモジュールやコンポーネントを適切に分割し、単一責任の原則を意識する。
- 全体として、可読性と保守性の高いコードベースを目指す。
