# JPEG XL対応タスク一覧

## タスク1: Rust側でのJPEG XL対応

### 1.1 画像拡張子リストへの追加
- [x] `src-tauri/src/navigation.rs`の`image_extensions`配列に`"jxl"`を追加

### 1.2 画像処理の制限対応
- [x] Cargo.tomlから誤って追加した`image`クレートの`jxl` featureを削除（存在しないため）
- [x] `src-tauri/src/img.rs`の`rotate_image`関数にJXL形式のチェックを追加し、適切なエラーメッセージを返すように実装

### 1.3 実装方針
- 案2を採用: ナビゲーションのみ対応、編集機能は当面サポート外
  - フォルダ内のJXL画像をリストアップして表示することは可能
  - 回転などの編集操作を試みた場合は、わかりやすいエラーメッセージを表示
  - 将来的にjxl-oxideなどの統合を検討

## タスク2: フロントエンド対応

### 2.1 サポート拡張子の追加
- [x] `src/lib/fileUtils.ts`の`SUPPORTED_EXTENSIONS`に`"jxl"`を追加
- [x] ドラッグ&ドロップでJXL画像を読み込めるように対応

## タスク3: ビルドとテスト

### 3.1 ビルド確認
- [x] `cargo check`を実行し、ビルドが成功することを確認
- [x] `cargo fmt`でコードをフォーマット
- [x] `npm run build`を実行し、フロントエンドのビルドが成功することを確認

### 3.2 動作確認（ユーザー側で実施）
- [ ] JXL画像をドラッグ&ドロップで読み込めることを確認
- [ ] JXL画像をフォルダに配置し、ナビゲーションでリストアップされることを確認
- [ ] JXL画像が表示できることを確認（ブラウザ対応状況による）
  - Chromiumベースのブラウザで、フラグを有効にすれば表示可能
- [ ] JXL画像の回転を試みた際、適切なエラーメッセージが表示されることを確認

## 補足

### 現在の実装状態
- ナビゲーション: JXL画像をフォルダ内でリストアップ可能
- 表示: ブラウザのJPEG XLサポート状況に依存（Tauriは表示のみ中継）
- 編集: 未サポート（エラーメッセージを表示）

### 今後の改善案
- jxl-oxideなどのクレートを使用して、JXL画像のデコード・エンコードをサポート
- または、PNG等の中間フォーマットへの変換機能を実装
