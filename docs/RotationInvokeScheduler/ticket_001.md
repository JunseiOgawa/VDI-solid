# Ticket #001: フロントエンドとバックエンドの回転処理統合
**優先度**: High

## 対象ファイル
- 変更: `src/context/AppStateContext.tsx` - 実ファイルパス保持と回転キュー制御のステート追加
- 変更: `src/components/Titlebar/index.tsx` - 回転ボタンを新しいキューAPIに接続
- 変更: `src/components/ImageViewer/index.tsx` - 実パス入力の保持とプレビュー回転状態の同期
- 変更: `src/lib/fileUtils.ts` - 実パスとアセットURLの併用ユーティリティ追加
- 変更: `src/lib/tauri.ts` もしくは新規 `src/lib/rotation.ts` - 回転コマンド呼び出しラッパー追加
- 変更: `src-tauri/src/img.rs` - 余剰回転角の最適化と負値対応

## 影響範囲
- 画像回転ボタン操作時のUI挙動
- 実ファイル書き換えが発生するバックエンド処理
- 画像読み込み・パス管理のロジック

## 実装手順
1. `AppStateContext` に実ファイルパスと回転ジョブ管理用のステートを追加し、画像切替時の初期化ロジックを更新する。
2. ドラッグ＆ドロップ等で取得するファイルパスをアセットURLと併せて保持できるよう `ImageViewer` と関連ユーティリティを整理する。
3. フロント側に回転キュー制御（90°刻み加算、3秒待機で実行、360°倍数はスキップ）を実装し、Titlebar の回転ボタンから利用する。
4. 回転確定時に Tauri の `invoke` で Rust コマンドを呼び出し、リクエスト中は追加押下をバッファリングする仕組みを整える。
5. Rust 側コマンドで受け取った角度の正規化（負値・360°倍数判定）と、早期リターン最適化を追加する。
6. Windows 環境で画像回転の連続操作を手動確認し、`npm run build` が成功することを確認する。

## 完了条件
- [ ] 連続で回転ボタンを押下した際に 3 秒以内であれば 90°刻みで累積され、バックエンド呼び出しが一度で完了する
- [ ] 累積角度が 360° の倍数のときはファイル書き換えが発生せず UI も元に戻る
- [ ] 実ファイルとプレビューの回転結果が一致し、処理中に追加押下しても破綻しない
- [ ] `npm run build` がエラーなく完了する
